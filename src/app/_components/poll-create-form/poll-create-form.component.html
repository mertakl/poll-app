<div class="container">
  <div class="card shadow-lg mb-3">
    <div class="card-body">
      <form [formGroup]="pollForm" ngxsForm='pollForm.poll'>
        <div class="form-group">
          <fieldset [disabled]="f.question.errors?.maxlength">
            <label for="question">Question</label>
            <input type="text" class="form-control" id="question"
                   formControlName="question">
          </fieldset>
          <small id="questionHelp" class="form-text text-muted">Max 80 characters.</small>
        </div>
        <ng-container formArrayName="choices">
          <div *ngFor="let choice of choices.controls; let i=index; let last = last;">
            <ng-container [formGroupName]="i">
              <div class="form-group">
                <label [for]="'choice-'+i">Choice</label>
                <div class="input-group">
                  <fieldset [disabled]="choice.get('name')?.errors?.maxlength">
                    <input type="text" class="form-control" [id]="'choice-'+i"
                           aria-describedby="choiceHelp"
                           formControlName="name">
                  </fieldset>
                  <div class="input-group-append">
                    <ng-container *ngIf="last && choices.length < 10; else remove">
                      <button class="btn btn-outline-secondary"
                              type="button" (click)="addNewChoice()">
                        <i class="ri-add-line"></i>
                      </button>
                    </ng-container>
                    <ng-template #remove>
                      <button class="btn btn-outline-secondary"
                              type="button" (click)="removeChoice(i)">
                        <i class="ri-close-line"></i>
                      </button>
                    </ng-template>
                  </div>
                </div>
                <small id="choiceHelp" class="form-text text-muted">Max 80 characters.</small>
              </div>
            </ng-container>
          </div>
        </ng-container>
      </form>
    </div>
  </div>
  <div class="d-flex mt-auto">
    <p class="small me-auto">{{10 - choices.length}} /10 Possible answers</p>
    <button type="button" class="btn btn-outline-secondary" (click)="reset()">Reset</button>
  </div>
</div>
